(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{209:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),e("p",[t._v("If you use CSF, then try to find the IP in "),e("router-link",{attrs:{to:"/ids_integration/#csf-integration"}},[t._v("CSF")]),t._v(" "),e("span",{staticClass:"notranslate"},[t._v("Allow/Deny")]),t._v(" Lists using their "),e("a",{attrs:{href:"https://support.configserver.com/knowledgebase/category/support%20",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation and support"),e("OutboundLink")],1),t._v(". If not, then do the following:")],1),t._v(" "),e("ul",[t._m(3),t._v(" "),e("li",[t._m(4),t._v(" "),e("ul",[e("li",[t._v("If the IP was found, then follow instructions on "),e("router-link",{attrs:{to:"/dashboard/#incidents"}},[t._v("Incidents page")]),t._v(" and perform the actions you need, like: add IP to the "),e("span",{staticClass:"notranslate"},[t._v("White List")]),t._v(" or disable the security rule that has detected this incident.")],1)])]),t._v(" "),e("li",[t._m(5),t._v(" "),e("ul",[e("li",[t._v("If the IP was found then follow this instruction for "),e("span",{staticClass:"notranslate"},[e("router-link",{attrs:{to:"/dashboard/#firewall"}},[t._v("Grey List")])],1),t._v(" or "),e("span",{staticClass:"notranslate"},[e("router-link",{attrs:{to:"/dashboard/#firewall"}},[t._v("Black List")])],1),t._v(" and move the IP to the "),e("span",{staticClass:"notranslate"},[t._v("White List")]),t._v(" or just remove from the "),e("span",{staticClass:"notranslate"},[t._v("Black List")]),t._v(" or "),e("span",{staticClass:"notranslate"},[t._v("Grey List")]),t._v(".")])])])]),t._v(" "),e("p",[t._v("If nothing helps, then "),e("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[t._v("contact our support team"),e("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(6),t._v(" "),e("p",[t._v("No. Imunify360 will not be able to stop an attack without IPtables and will not be able to detect an attack without OSSEC.")]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),e("p",[t._v("The following info is sent to our server:")]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),e("p",[t._v("Check if the agent is running.")]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),e("p",[t._v("Imunify360 uses SQLite database to store its data. Although this database has proved its reliability, database files become corrupted in rare cases. To restore data try to perform the following steps:")]),t._v(" "),e("p",[t._v("Stop the agent.")]),t._v(" "),e("p",[t._v("If you have sqlite3 application installed on your machine, try to make dump of Imunify360 database:")]),t._v(" "),t._m(20),t._v(" "),t._m(21),t._v(" "),e("p",[t._v("Create a new database from this dump file:")]),t._v(" "),t._m(22),t._v(" "),e("p",[t._v("Replace old database with the new one:")]),t._v(" "),t._m(23),t._v(" "),e("p",[t._v("Start the Imunify360 agent.")]),t._v(" "),e("p",[t._v("If these steps have not solved the problem or no sqlite3 package is installed, then you should create a completely new database:")]),t._v(" "),e("p",[t._v("Stop the agent.")]),t._v(" "),t._m(24),t._v(" "),e("p",[t._v("Start the agent")]),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),e("p",[t._v("Please find more FAQs in our "),e("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/sections/115001538929-FAQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Knowledge Base"),e("OutboundLink")],1),t._v(".")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),e("p",[t._v("Example of contents of such config file:")]),t._v(" "),t._m(29),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),e("p",[t._v("Fields:")]),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),e("p",[t._v("The solution is available in "),e("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/en-us/articles/360022689394-How-to-Clone-Imunify360-Installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("FAQ section"),e("OutboundLink")],1)]),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),t._m(43),t._v(" "),e("p",[t._v("Sometimes, you may need to delete all usersâ€™ scan results from the server. This should not be common practice, and we do not recommend doing it on a regular basis. But, if you do need to erase the results of all Imunify360 scans, you can find the instructions below.")]),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),e("p",[t._v("(on CentOS 7)\n")]),t._m(46),t._v(" "),e("p",[t._v("(on CentOS 6, Ubuntu)")]),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50),t._v(" "),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._v(" "),e("p",[t._v("(on CentOS 7)\n")]),t._m(54),t._v(" "),e("p",[t._v("(on CentOS 6, Ubuntu)")]),t._v(" "),t._m(55),t._v(" "),t._m(56),t._v(" "),t._m(57),t._v(" "),t._m(58)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"faq-and-known-issues"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#faq-and-known-issues","aria-hidden":"true"}},[this._v("#")]),this._v(" FAQ and Known Issues")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"common-questions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#common-questions","aria-hidden":"true"}},[this._v("#")]),this._v(" Common Questions")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_1-end-user-ip-is-blocked-and-i-do-not-know-why"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-end-user-ip-is-blocked-and-i-do-not-know-why","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. End user IP is blocked and I do not know why")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("Go to cPanel Plugins section, choose Imunify360 and enter the "),s("span",{staticClass:"notranslate"},[this._v("Incidents")]),this._v(" page.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Make sure that the IP checkbox at the top of the table is ticked. Enter proper IP or part of IP in the input field and click "),s("em",[this._v("Enter")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If the IP was not found on the Incidents page, then go to Firewall page and using the same way as in the previous step try to find proper IP in "),s("span",{staticClass:"notranslate"},[this._v("Black List")]),this._v(" or "),s("span",{staticClass:"notranslate"},[this._v("Grey List")]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Most Imunify360 logs are saved in "),s("span",{staticClass:"notranslate"},[s("code",[this._v("/var/log/imunify360/console.log")])]),this._v(". For example, when IP is blocked and added to the "),s("span",{staticClass:"notranslate"},[this._v("Black List")]),this._v(", the following lines are added:")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language-Python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[t._v("INFO "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("889")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefence360agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protector"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy_init"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" IP "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("103.86")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".52")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".175")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" BLOCKED\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v(" sec "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("expiration"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492281300")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("due to SensorAlert"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nINFO "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("889")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefence360agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protector"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy_init"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Unblocking "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("103.86")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".52")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".175")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\nCSF "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" it "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" already "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" our graylist\nINFO "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("663")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" defence360agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("internals"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("the_sink"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nSensorAlert"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rule_id'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'LF_SMTPAUTH'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492281000.8720655")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attackers_ip'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'103.86.52.175'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plugin_id'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lfd'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'method'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ALERT'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ttl'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nWhen user unblocks himself by captcha"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" logs look like this"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nINFO "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("956")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" defence360agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("internals"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("the_sink"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nCaptchaEvent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492404686.9496775")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'errors'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user_agent'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'accept_language'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'event'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'PASSED'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'method'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CAPTCHA'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attackers_ip'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10.101.1.18'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nINFO "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("967")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefence360agent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protector"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy_init"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" IP "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.101")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".18")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" UNBLOCKED\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("due to ClientUnblock"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Adding and removing IPs from the "),s("span",{staticClass:"notranslate"},[this._v("White List")]),this._v(" is only possible manually, no IPs will be added automatically.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information","aria-hidden":"true"}},[this._v("#")]),this._v(" 5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("all the messages from IDS OSSEC (can be found in OSSEC logs)")]),t._v(" "),e("li",[t._v("all the messages from "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" (can be found in "),e("span",{staticClass:"notranslate"},[e("code",[t._v("modsec_audit.log")])]),t._v(")")]),t._v(" "),e("li",[t._v("users domains (to be checked in reputation engine);")]),t._v(" "),e("li",[t._v("CAPTCHA verification info")]),t._v(" "),e("li",[t._v("all running scans for malware (maldet scans) and information on moving to the quarantine or discovering suspicious files")]),t._v(" "),e("li",[t._v("optionally, suspicious files can be sent to us for the analysis. Files can be sent via UI by marking a proper checkbox")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_6-no-valid-imunify360-license-found"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-no-valid-imunify360-license-found","aria-hidden":"true"}},[this._v("#")]),this._v(" 6. No valid Imunify360 License Found.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Check access to the central server ("),s("span",{staticClass:"notranslate"},[s("code",[this._v("IP: 148.251.130.176 port: 443)")])]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Call "),s("span",{staticClass:"notranslate"},[s("code",[this._v("imunify360-agent rstatus")])]),this._v(" and ensure that status is "),s("span",{staticClass:"notranslate"},[s("code",[this._v("True")])]),this._v(":")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("{'expiration': 0, 'status': True, 'user_count': None, 'user_limit': None, 'redirect_url': None}\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Ensure that "),s("span",{staticClass:"notranslate"},[s("code",[this._v("/etc/sysconfig/imunify360/imunify360.id")])]),this._v(" file contains "),s("span",{staticClass:"notranslate"},[s("code",[this._v("server_id")])]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If no, "),s("span",{staticClass:"notranslate"},[s("code",[this._v("imunify360-agent register KEY")])]),this._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do","aria-hidden":"true"}},[this._v("#")]),this._v(" 7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("#sqlite3 /var/imunify360/imunify360.db\n.mode insert\n.output dump_all.sql\n.dump\n.exit\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("You should see new file "),s("span",{staticClass:"notranslate"},[s("code",[this._v("dump_all.sql")])]),this._v(" in the directory "),s("span",{staticClass:"notranslate"},[s("code",[this._v("/var/imunify/")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("#sqlite3 imunify360.db.new < dump_all.sql\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("#cd /var/imunify/\n#mv imunify360.db imunify360.db.corrupt && mv imunify360.db.new imunify360.db\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("#rm /var/imunify/imunify360.db\n#imunify360-agent migratedb\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360","aria-hidden":"true"}},[this._v("#")]),this._v(" 8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("OWASP rule set may conflict with Imunify360 default rule set on a server running "),s("span",{staticClass:"notranslate"},[this._v("LiteSpeed Web Server")]),this._v(". We recommend to turn off OWASP rule set prior to installing Imunify360.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_9-disabling-waf-rules-for-certain-countries"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-disabling-waf-rules-for-certain-countries","aria-hidden":"true"}},[this._v("#")]),this._v(" 9. Disabling WAF rules for certain countries.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("It is possible to disable some WAF rules for IPs that are resolved to be from some country (or other geographical entity).\nTo implement this, a customer should create his own modsecurity configuration file, and include it into the default modsecurity configuration. In case of cPanel, this can be done by creating "),s("span",{staticClass:"notranslate"},[s("code",[this._v("/etc/apache2/conf.d/includes/countrywafrules.conf")])]),this._v(" and adding it as an include to the "),s("span",{staticClass:"notranslate"},[s("code",[this._v("/etc/apache2/conf.d/modsec/modsec2.cpanel.conf")])]),this._v(". Otherwise configuration files might be rewritten by Imunify360 rules update.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('SecGeoLookupDb /path/to/GeoLiteCity.dat \n# ModSecurity relies on the free geolocation databases (GeoLite City and GeoLite Country) that can be obtained from MaxMind http://www.maxmind.com. Currently ModSecurity only supports the legacy GeoIP format. Maxmind\'s newer GeoIP2 format is not yet currently supported.\nSo a customer need to download this IP database and locate somewhere.\n\n# Lookup IP address \nSecRule REMOTE_ADDR "@geoLookup" "phase:1,id:155,nolog,pass"\n\n# Optionally block IP address for which geolocation failed\n# SecRule &GEO "@eq 0" "phase:1,id:156,deny,msg:\'Failed to lookup IP\'"\n\n# Skip rules 942100 and 942101 for GB country as example\n\nSecRule GEO:COUNTRY_CODE "@streq GB" "phase:2,auditlog,id:157,pass,severity:2,\\\nctl:ruleRemoveById=942100,\\\nctl:ruleRemoveById=942101"\n')])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Make sure that you have replaced "),s("span",{staticClass:"notranslate"},[s("code",[this._v("/path/to/GeoLiteCity.dat")])]),this._v(" with the real path to the GeoLiteCity.dat file installed in your system.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Variable "),s("span",{staticClass:"notranslate"},[s("code",[this._v("GEO")])]),this._v(" is a collection populated by result of the last "),s("span",{staticClass:"notranslate"},[s("code",[this._v("@geoLookup")])]),this._v(" operator. The collection can be used to match geographical fields looked from an IP address or hostname.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("Note")]),this._v(" "),s("p",[this._v("Available since ModSecurity 2.5.0.")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("COUNTRY_CODE")])]),t._v(": two character country code. Example: "),e("code",[t._v("US")]),t._v(", "),e("code",[t._v("GB")]),t._v(", etc.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("COUNTRY_CODE3")])]),t._v(": up to three character country code.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("COUNTRY_NAME")])]),t._v(": full country name.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("COUNTRY_CONTINENT")])]),t._v(": two character continent that the country is located. Example: "),e("code",[t._v("EU")]),t._v(".")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("REGION")])]),t._v(": two character region. For US, this is state. For Canada, providence, etc.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("CITY")])]),t._v(": city name if supported by the database.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("POSTAL_CODE")])]),t._v(": postal code if supported by the database.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("LATITUDE")])]),t._v(": latitude if supported by the database.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("LONGITUDE")])]),t._v(": longitude if supported by the database.")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("DMA_CODE")])]),t._v(": metropolitan area code if supported by the database. (US only)")]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[e("code",[t._v("AREA_CODE")])]),t._v(": phone system area code. (US only)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_10-how-to-clone-imnify360-configuration-on-another-system"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_10-how-to-clone-imnify360-configuration-on-another-system","aria-hidden":"true"}},[this._v("#")]),this._v(" 10. How to clone Imnify360 configuration on another system?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_11-how-to-disable-support-icon-in-the-imunify360-ui"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_11-how-to-disable-support-icon-in-the-imunify360-ui","aria-hidden":"true"}},[this._v("#")]),this._v(" 11. How to disable Support icon in the Imunify360 UI?")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("Go to "),e("span",{staticClass:"notranslate"},[e("code",[t._v("/etc/sysconfig/imunify360/imunify360.config")])]),t._v(".")]),t._v(" "),e("li",[t._v("And set "),e("span",{staticClass:"notranslate"},[e("code",[t._v("PERMISSIONS.support_form:")])]),t._v(" option to "),e("span",{staticClass:"notranslate"},[e("code",[t._v("false")])]),t._v(".")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("OR, "),s("strong",[this._v("better")]),this._v(", run the following command:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('imunify360-agent config update \'{"PERMISSIONS": {"support_form": false}}\'\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui","aria-hidden":"true"}},[this._v("#")]),this._v(" 12. How to hide the Ignore List tab for end users in the Imunify360 UI?")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("Go to "),e("span",{staticClass:"notranslate"},[e("code",[t._v("/etc/sysconfig/imunify360/imunify360.config")])]),t._v(".")]),t._v(" "),e("li",[t._v("And set "),e("span",{staticClass:"notranslate"},[e("code",[t._v("PERMISSIONS.user_ignore_list:")])]),t._v(" option to "),e("span",{staticClass:"notranslate"},[e("code",[t._v("false")])]),t._v(".")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("OR, "),s("strong",[this._v("better")]),this._v(", run the following command:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v('imunify360-agent config update \'{"PERMISSIONS": {"user_ignore_list": false}}\'\n')])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"_13-how-to-delete-malware-scan-results-from-imunify360â€™s-database"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_13-how-to-delete-malware-scan-results-from-imunify360â€™s-database","aria-hidden":"true"}},[this._v("#")]),this._v(" 13. How to delete malware scan results from Imunify360â€™s database?")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[this._v("First, you need to stop the agent:")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("systemctl stop imunify360\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("p"),this._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("service imunify360 stop\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"2"}},[s("li",[this._v("Connect to the Imunify360 database by running this command:")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("sqlite3 /var/imunify360/imunify360.db\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"3"}},[s("li",[this._v("Execute the following SQL commands:")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("IMPORTANT")]),this._v(" "),s("p",[this._v("This will remove all scan results from Imunify360!")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("DELETE FROM malware_history;\nDELETE FROM malware_hits;\nDELETE FROM malware_scans;\nDELETE FROM malware_user_infected;\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"4"}},[s("li",[this._v("Start the Imunify360 service:")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("systemctl start imunify360\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("p"),this._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("service imunify360 start\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("We donâ€™t recommend cleaning the scan results for specific users, as it may cause inconsistencies in the "),s("span",{staticClass:"notranslate"},[s("code",[this._v("malware_scans")])]),this._v(" table. But, in emergencies, you can do it with these SQL commands:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("DELETE FROM malware_history WHERE file_onwer = <user>;\nDELETE FROM malware_hits WHERE user = <user>;\nDELETE FROM malware_user_infected WHERE user = <user>;\n")])])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Unfortunately, thereâ€™s no easy way to delete records in the "),s("span",{staticClass:"notranslate"},[s("code",[this._v("malware_scans")])]),this._v(" table for a specific user, so the table should be either truncated with the other tables shown in step 2 above, or the records should just be ignored.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you need any more information on this or anything else related to Imunify360 administration, please "),s("a",{attrs:{href:"mailto:feedback@imunify360.com"}},[this._v("get in touch")]),this._v(" .")])}],!1,null,null,null);s.default=n.exports}}]);